<!DOCTYPE html>
<!-- This is a very simple example of using Web World Wind. -->
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Satellio berry monitor</title>
    <!-- Include the Web World Wind library. -->
    <script src="http://worldwindserver.net/webworldwind/worldwind.min.js" type="text/javascript"></script>
	<script src="bb.js" type="text/javascript"></script>
	
<style>

#container {
	text-align:center;
}

</style>
</head>
<body>
	
<div id="container">
<div id="left">
<h1>Satellio berry monitor</h1>
<p>Satellio berry monitor uses World Wind technology to visualize the locations where you are most likely to find blueberries in Finland.</p>

<p>The results are based on open satellite data (Landsat, Sentinel) combined with open land cover and forestry data (Corine, VMI).</p>

<p>The source code of the application is available here: <a href="index.html" download>index.html</a>, <a href="bb.js" download>bb.js</a></p>

<p>contact@satellio.com, <a href="http://www.satellio.com">www.satellio.com</a></p>

</div>
<div id="right">
    <!-- Create a canvas for Web World Wind. -->
    <canvas id="canvasOne" width="1024" height="768">
        Your browser does not support HTML5 Canvas.
    </canvas>
</div>
</div>
<script>
    // Register an event listener to be called when the page is loaded.
    window.addEventListener("load", eventWindowLoaded, false);

    // Define the event listener to initialize Web World Wind.
    function eventWindowLoaded() {
        // Create a World Window for the canvas.
        var wwd = new WorldWind.WorldWindow("canvasOne");

        // Add some image layers to the World Window's globe.
        wwd.addLayer(new WorldWind.BMNGOneImageLayer());
        wwd.addLayer(new WorldWind.BingAerialWithLabelsLayer());

        // Add a compass, a coordinates display and some view controls to the World Window.
        wwd.addLayer(new WorldWind.CompassLayer());
        wwd.addLayer(new WorldWind.CoordinatesDisplayLayer(wwd));
        wwd.addLayer(new WorldWind.ViewControlsLayer(wwd));
        
        
        // Create a layer to hold the polygons.
        var polygonsLayer = new WorldWind.RenderableLayer();
        polygonsLayer.displayName = "Polygons";
        wwd.addLayer(polygonsLayer);



        for (var i=0;i<coords["features"].length;i=i+5) {  //1000;i++) { //
        
        //console.log(coords["features"][0]["geometry"]["coordinates"][0][i];
        
        
        // Define an outer and an inner boundary to make a polygon with a hole.
        var boundaries = [];
        boundaries[0] = []; // outer boundary
        
        for (var j=0;j<coords["features"][i]["geometry"]["coordinates"][0].length;j++){
        
        boundaries[0].push(new WorldWind.Position(coords["features"][i]["geometry"]["coordinates"][0][j][1], coords["features"][i]["geometry"]["coordinates"][0][j][0], 400));
        //boundaries[0].push(new WorldWind.Position(61, 22, 1e3));
        //boundaries[0].push(new WorldWind.Position(60, 22, 1e3));
		}
        //boundaries[1] = []; // inner boundary
        //boundaries[1].push(new WorldWind.Position(41, -103, 1.7e4));
        //boundaries[1].push(new WorldWind.Position(44, -110, 1.7e4));
        //boundaries[1].push(new WorldWind.Position(41, -117, 1.7e4));

        // Create the polygon and assign its attributes.

        var polygon = new WorldWind.Polygon(boundaries, null);
        polygon.altitudeMode = WorldWind.RELATIVE_TO_GROUND;
        polygon.extrude = true; // extrude the polygon edges to the ground
        
                var polygonAttributes = new WorldWind.ShapeAttributes(null);
        polygonAttributes.drawInterior = true;
        polygonAttributes.drawOutline = true;
        polygonAttributes.outlineColor = WorldWind.Color.BLUE;
        polygonAttributes.interiorColor = new WorldWind.Color(0, 1, 1, 0.5);
        polygonAttributes.drawVerticals = polygon.extrude;
        polygonAttributes.applyLighting = true;
        polygon.attributes = polygonAttributes;

        // Create and assign the polygon's highlight attributes.
        var highlightAttributes = new WorldWind.ShapeAttributes(polygonAttributes);
        highlightAttributes.outlineColor = WorldWind.Color.RED;
        highlightAttributes.interiorColor = new WorldWind.Color(1, 1, 1, 0.5);
        polygon.highlightAttributes = highlightAttributes;

        // Add the polygon to the layer and the layer to the World Window's layer list.
        polygonsLayer.addRenderable(polygon);
        
        wwd.goTo(new WorldWind.Location(61,21));
		}







        
    }
</script>
</body>
</html>
